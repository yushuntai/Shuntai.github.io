---
layout: post
title:  " GSEA软件使用"
tags: 实验方法与科研小技巧
date:   2024-2-26
categories: Front-end JavaScript
excerpt: 实验方法与科研小技巧
---


**目录：**

* content
{:toc}


# 原始蛋白质谱的文件处理

原始文件进行修改，只需要留下Gene name和6个样本名字，如下：

![image](https://github.com/yushuntai/yushuntai.github.io/assets/61654690/03b9e0eb-3ff4-4c5f-a4da-c18d81d6e79d)


（1） 将空格全部改写成NA，同时把基因名为--的全部删除，删除的方法：选中基因名字列——排序和筛选——筛选——在gene name右侧的小三角中选中。

![image](https://github.com/yushuntai/yushuntai.github.io/assets/61654690/b2bb4c64-f6dc-4992-a1f3-206c9af8c1e4)


（2） 创建GSEA.txt文件并将上面excel中的信息粘贴进GSEA.txt文件
（3） 打开GSEA_4.3.3软件——Load data——Browse for files...——（这一步经常出问题，报错如下：

![image](https://github.com/yushuntai/yushuntai.github.io/assets/61654690/f6df98dc-fca2-4abb-ad5f-b157f45c1e23)

解决方法：
将文件中信息清除，然后手动打进去如下信息，再次导入GSEA软件，就会成功，提示如下。

![image](https://github.com/yushuntai/yushuntai.github.io/assets/61654690/7b847674-b431-46d0-bccd-0d6286f70ff3)


将上传成功的文件清除（Purge 3 Selected Files）

![image](https://github.com/yushuntai/yushuntai.github.io/assets/61654690/7a243f53-4038-4040-8039-051135ee9f8d)

将GSEA.txt文件中手打的内容清除，将excel中的信息粘贴进GSEA.txt文件，再次上传


点Phenotype labels——Create an on-the-fly Phenotype——填写好信息（要和.txt文件中的对应）如(1)所示——Apply to dataset——出现成功提示(2)后点确定再close——点(3)中的Show phenotypes from all source files——选中阴影处——OK
注：如果（3）中选的是ctrl vs ANKRD5-ko,cls#ANKRD5-ko versus ctrl 则最终出的结果是ANKRD5-ko上调的，如果选的是 ctrlvs ANKRD5-ko.cls#ctrl versus ANKRD5-KO 则最终出的结果是ctrl上调的。

![image](https://github.com/yushuntai/yushuntai.github.io/assets/61654690/3c58b7c0-dac5-48bd-b922-b506c460591b)



Expression dataset：:导入表达数据集文件，点击后自动显示上一一步中从本地导入软件内的文件，所以定要确认上一步等入数据是否成功。我的文档显示的是  **GSEA [4896x6 (ann: 4896,6,chip na)]**  <br>
Gene sets database：这是软件自带的基因功能集数据库，包括GO/KEGG/wikipathway等等，可以几个数据库都试试，看能不能富集到一些有用信息，也可以下载GSEA官网中的gene sets文件，然后自己导入。<br>
Number of permutations:置换检验的次数，数字越大结果越准确，但是太大会占用太多内存，软件跃认检验1000次。软件分析时会得到一个基因富集的评分(ES)，但是富集评分是否具有统计学意义，软件就会采用随机模拟的方法，根据指定参数随机打乱1000次到1000个富集评分，然后判断得到的ES是否在这1000个随机产生的得分中有统计学意义。测试使用时建议填一个很小的数如10，先让程序跑通。真正分析时再换为1000。 <br>
Collapse/Remap to gene symbols是用于基因芯片探针号转化成gene symbols的，这里不用转置，所以选No_Collapse。<br>
Permutation type是置换检验的type，如果样本数每组少于7个就选gene_set，如果样本数比较多就选phenotype。<br>
Chip platform是基因芯片的数据才需要设置的，所以这里直接空着就行。<br>
Basic fields 里面Max size: exclude larger sets 和 Min size: exclude smaller sets表示如果要进行GSEA运算则需要满足的富集到的最大基因数和最小基因数，这里是可以自由调整的，我将后者调为了1，因为我的样本数量少的问题。<br>












(1) 将文件37℃预热的PBS 游离△/+ 和 ANKRD5-cFLAG 的精子 45min。 <br>
(2) 3000rcf 3min 4℃离心机离心，用冰的PBS重悬3000rcf 3min 4℃离心机离心。 <br>
(3) 300μLPBS重悬 + 300μL的 4% PFA 混匀后37℃ 5min + RT 20min 固定。<br>
(4) 3000rcf 3min 4℃离心机离心，清洗两次精子，900μL 冰PBS重悬。<br>
(5) 300μL + 2.8mL PBS混匀，涂成一个圆，然后静置2s，吸走液体。总共涂了18个片子。<br>
(6) 剩余600μL的 △/+ 和 ANKRD5-cFLAG 的精子离心弃上清。<br>
(7) **打孔：** 步骤(5)的3个片子用 0.5% TritonX-100 in PBS 摇床上浸泡20min；步骤(6)的精子沉淀用0.5% TritonX-100 in PBS 重悬，摇床上20min。<br>
(8) PBS 5min X 2。<br>
(9) **抗原修复：** 沸水中 TE 抗原修复30min，过夜静置至室温。<br>
(10) PBST (PBS with 0.1% Triton X-100)洗5*3min（让片子躺着）。<br>
(11) **封闭：**

**片子1：** 先用ADB稀释抗鼠的二抗(1:100) RT 40min，先ADB封闭1h。（理论上应该反过来）； 一抗为 FLAG(M2)+α-Tubulin(R) 1:100<br>
**片子2：** ADB封闭2h。一抗为 FLAG(M2)+α-Tubulin(R) 1:100<br>
**片子3：** ADB封闭2h。一抗为 FLAG(R)+α-Tubulin(M) 1: 100<br>
**Tube-flag 和 Tube-△/+** ADB封闭2h， FLAG(R)+α-Tubulin(M) 1:100。<br>
(12) **一抗孵育过夜**
(13) PBST (PBS with 0.1% Triton X-100)洗5*3min（让片子躺着）。<br>
(14) **二抗孵育**
二抗孵育是20μL的抗体，然后用PE手套，剪成1cm大小的方块，然后覆盖在抗体滴上，这样比较均匀。<br>
二抗：1:100，室温孵育 1 小时。<br>
片子1 & 片子2：star red 山羊抗小鼠➕star orange 山羊抗兔<br>
片子3 & Tube：star red 山羊抗兔➕star orange 山羊抗小鼠<br>

(15) PBST (PBS with 0.1% Triton X-100)洗10*3min（让片子躺着）。<br>
(16) 指甲油封片，封片前过一遍ddH2O。<br>




tube 
右侧G-R orange1;100

(9)
(10)





TE抗原修复：100℃ 40min，常温冷却至室温。<br>
(6) 取出1/3 精子用于精子涂片，其余精子先做抗体孵育然后涂片子。 <br>

# 各个文件的信息介绍。

![image](https://github.com/yushuntai/yushuntai.github.io/assets/61654690/03d092c5-a5be-4ed8-9586-246202b3c328)


（1）.obf是原始文件，可以用stedycon、fiji、Huygens等软件打开，如果是层扫的，则用stedycon打开该原始文件后能看到有Z轴可以调节。<br>（2）.zip 压缩包里的tiff文件是单通道文件。<br>（3）.txt文件是拍照时候的一些信息。<br>

![image](https://github.com/yushuntai/yushuntai.github.io/assets/61654690/00cdcdbb-c027-4c8f-8eea-1519dd9b3d12)

（1）名字中后缀的 ch00 和 ch01是两个不同的荧光通道。两个Z000_ch00和Z000_ch01是同一个Z平面两个荧光通道的照片。Z000、Z001、Z002 是属于不同的Z平面<br>


StedyconGallery-9.0.538-gf4f0d25-win64.msi，可以打开Abberior STEDYCON拍摄的原始文件，可以查看和简单测量，可以将文件导出成图片或PDF格式

**主要参考** [STEDYCON下载链接](https://cloud.tsinghua.edu.cn/f/e82232f882fc47c39eb7/)   
安装路径全部用英文名，将STEDYCON下载的obf文件解压到全英文路径，双击obf文件即可打开

# 打开原文件

STEDYCON 软件打开.obf 文件
![image](https://github.com/yushuntai/yushuntai.github.io/assets/61654690/0cf0fd68-fe7e-41a4-a1b6-01c39c3a583e)
根据该原文件中的颜色分布和当时染色的颜色搭配来确定TIF灰度图文件中ch00 和 ch01分别是染的哪个蛋白，根据不同的Z轴来选择不同的Z平面。

# FIJI image J对文件进行调色和编辑

打开Fiji imageJ软件。我用的FLAG（R）和Tubulin（m），ch00 为 FLAG 绿色，ch01 为 tubulin 红色，tubulin和FLAG都是用的1:500，这次抗体浓度太稀了，下次提高抗体浓度和解决背景太高的问题。

![image](https://github.com/yushuntai/yushuntai.github.io/assets/61654690/a795b8f7-c3a9-4dab-8d5b-fa7533ea721b)


**添加伪彩**：将TIF图片拉进FIJI image J——LUT——Green（点另一个图片，选Red）<br>
**调对比度**：Image——adjust——Brightness/Contrast（Color Balance，我觉得用color balance调的更好）——minimum是去背景，让暗的更暗，Maximum是让一些亮的更亮<br>
**Merge图片**：Image——color——Merge Channel——C1选上一个图片，C2选上一个图片——OK即可<br>
**Merge后的调整**：滑动merge好的图片下方的键又会出现Color键，在这里也可以调节颜色和对比度之类的。<br>
**图片的输出**：file——save as——Jpeg或者png等。<br>






